<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width,minimum-scale=1,initial-scale=1">
<link rel="stylesheet"
	href="http://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" type="text/css" href="zigbang.css">
<link rel="stylesheet" type="text/css" href="daumMap.css">
<title>ZigbangTest</title>
</head>
<body>
	<div class="wrap">
		<div class="header">
			<div class="icon-wrap">
				<a class="back-btn" href="#"><img src="i-img/left-arrow.png"></a>
				<p class="r_addr"></p>
				<a class="like-btn" href="#"><img src="i-img/favorite.png"></a>
				<a class="share-btn" href="#"><img src="i-img/share.png"></a>
			</div>
		</div>
		<div class="container">
			<div id="sliderWrapper">
				<ul id="imgSlider" data-index="0">
				</ul>
				<button id="back">&#10094;</button>
				<button id="next">&#10095;</button>
				<!-- 				<img class="r_img" id="room_img" src="" alt="roomInside" -->
				<!-- 					style="margin: 0; width: 360px; height: 360px;"/> -->
				<div class="safe_agent_enroll">
					<img src="i-img/img_ansim_logo.png" alt="안심로고"><span>TM</span>
					<p>가 등록한 방입니다.</p>
					<a href=""><img src="i-img/question.png"
						style="width: 20px; height: 20px;"></a>
				</div>
			</div>
			<div class="room_Info_wrap">
				<p class="r_intro"></p>
				<table id="room_Info">
					<tbody>
						<tr>
							<td class="td_l">보증금</td>
							<td class="td_r r_deposit"><strong></strong> 만원</td>
						</tr>
						<tr>
							<td class="td_l">월세</td>
							<td class="td_r r_rentsCost"><strong></strong> 만원</td>
						</tr>
						<tr class="ud_line">
							<td class="td_l">등록번호</td>
							<td class="td_r r_id"></td>
						</tr>
						<tr>
							<td class="td_l">주소</td>
							<td class="td_r r_address"></td>
						</tr>
						<tr>
							<td class="td_l">인근전철역</td>
							<td class="td_r r_nearStation"></td>
						</tr>
						<tr>
							<td class="td_l">층/건물층수</td>
							<td class="td_r r_floor"></td>
						</tr>
						<tr>
							<td class="td_l">크기</td>
							<td class="td_r r_size"></td>
						</tr>
						<tr>
							<td class="td_l">구조</td>
							<td class="td_r r_structure"></td>
						</tr>
						<tr class="ud_line">
							<td class="td_l">건물형태</td>
							<td class="td_r r_form"></td>
						</tr>
						<tr>
							<td class="td_l">옵션</td>
							<td class="td_r r_option"></td>
						</tr>
						<tr>
							<td class="td_l">관리비</td>
							<td class="td_r r_maintenance"></td>
						</tr>
						<tr>
							<td class="td_l">관리비 포함항목</td>
							<td class="td_r r_maintenanceAdd"></td>
						</tr>
						<tr>
							<td class="td_l">주차</td>
							<td class="td_r r_parking"></td>
						</tr>
						<tr>
							<td class="td_l">엘리베이터</td>
							<td class="td_r r_elevator"></td>
						</tr>
						<tr>
							<td class="td_l">입주 가능일</td>
							<td class="td_r r_date"></td>
						</tr>
					</tbody>
				</table>
				<div class="other_info">
					<p>상세설명</p>
					<div class="r_desc"></div>
				</div>
				<div class="other_info">
					<p>담당자 한마디</p>
					<div class="agent_word"></div>
				</div>
				<div class="other_info">
					<p>건물정보</p>
					<div class="office_info">
					  <div class="office_img">
  						<img id="office_img" src="" alt="건물사진">
					  </div>
						<div class='office_info_wrap'>
							<p id="office_name"></p>
							<p id="office_addr"></p>
							<p id="office_floor"></p>
							<p id="office_rooms"></p>
							<p id="office_est"></p>
						</div>
					</div>
				</div>
				<div class="other_info" id="daum_Map">
					<p>위치보기</p>
					<div class="map_info">
  					<div id="map_container" class="view_map">
	  					<div id="mapWrapper"
		  					style="width: 100%; height: 300px; position: relative;">
			  				<div id="map" style="width: 100%; height: 100%"></div>
			  				<div id="roadview" style="width: 100%; height: 100%; display:none;"></div>
				  			<input type="button" id="btnRoadview" onclick="toggleMap(false)"
					  			title="로드뷰 보기" value="로드뷰">
					  		<input type="button" id="btnMap" onclick="toggleMap(true)" title="지도 보기" value="지도">
						  </div>
					  </div>
					</div>
				</div>
				<div id="agent_Info">
					<p>중개사정보</p>
					<div>
						<div class="agent_Info">
							<div class="agent_img_wrap">
								<img class="agent_img" alt="중개사사진" src=""
									style="width: 99px; height: 99px;">
								<div class="safe-tag">
									<img src="i-img/img_ansim_logo.png" alt="ansim_logo">
								</div>
							</div>
							<div class="agent_profile">
								<p>
									<b>대표공인중개(<span class="agent_name"></span>)
									</b>
								</p>
								<p class="agent_email"
									style="color: #666666; font-weight: lighter;"></p>
								<p class="agent_tel"
									style="color: #666666; font-weight: lighter;"></p>
							</div>
						</div>
						<div class="office_Info">
							<p>
								<b>중개사무소 정보</b>
							</p>
							<ul>
								<li id="office_address"
									style="color: #666666; font-weight: lighter;"></li>
								<li id="office_call"
									style="color: #666666; font-weight: lighter;">대표번호 : <span></span></li>
							</ul>
						</div>
					</div>
				</div>
				<div class="agent_CMT">
					<div class="agent_comment"> 이 방은 <b>공인중개사 등록한 중개매물</b>입니다.<br> 공인 중개사를 통해 <b>안전하게
							계약</b>할 수 있으며, <b>법정 중개 보수가 발생</b>합니다.
					</div>
				</div>
			</div>
		</div>
		<div id="footer">
			<div class="inquiry">
				<p class="inquiry_office"></p>
				<p class="inquiry_agent"></p>
				<p class="inquiry_tel"></p>
				<strong>중개</strong>
			</div>
			<a class="tel_Btn" href=""><img src="i-img/call.png">문의하기</a>
		</div>
		<div id="Modal-Wrap">
			<div class="modal-conts">
				<img class="modal-img" src="i-img/room_inside1.png">
			</div>
		</div>
		<div id="rvWrapper"
			style="width: 100%; height: 300px; position: absolute; top: 0; left: 0;">
			<div id="roadview" style="height: 100%"></div>
			<input type="button" id="btnMap" onclick="toggleMap(true)"
				title="지도 보기" value="지도">
		</div>
	</div>
	<script src="http://code.jquery.com/jquery-latest.min.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script type="text/javascript"
		src="//apis.daum.net/maps/maps3.js?apikey=664fd55b53d6853075b5d05a66e6cd66&libraries=services"></script>
	<!-- 	<script type="text/javascript" src="zigbang.js"></script> -->
	<!-- 	<script type="text/javascript" src="daumMap.js"></script> -->
	<script>
	
	var winH = $(window).height();
	var roomAddr;

	var rvContainer = document.getElementById('roadview'), // 로드뷰를 표시할 div 입니다
    mapContainer = document.getElementById('map'); // 지도를 표시할 div 입니다

	  var mapOption = {
	         center: new daum.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
	         level: 3 // 지도의 확대 레벨
	     };  

	 // 지도를 생성합니다    
	 var map = new daum.maps.Map(mapContainer, mapOption); 
	 
	// 로드뷰 어쩌고
	 var roadviewClient = new daum.maps.RoadviewClient();
	// 로드뷰 객체를 생성합니다 
	 var roadview = new daum.maps.Roadview(rvContainer);
	
	// 로드뷰의 위치를 특정 장소를 포함하는 파노라마 ID로 설정합니다
     // 로드뷰의 파노라마 ID는 Wizard를 사용하면 쉽게 얻을수 있습니다 
     roadview.setPanoId(1023434522, new daum.maps.LatLng(33.450701, 126.570667));

     // 특정 장소가 잘보이도록 로드뷰의 적절한 시점(ViewPoint)을 설정합니다 
     // Wizard를 사용하면 적절한 로드뷰 시점(ViewPoint)값을 쉽게 확인할 수 있습니다
     roadview.setViewpoint({//고
         pan: 321,
         tilt: 0,
         zoom: 0
     });
	 // 주소-좌표 변환 객체를 생성합니다
	 var geocoder = new daum.maps.services.Geocoder();
	 
	  function map_addr(){
	    console.log("roomAddr2: "+roomAddr);
	    // 주소로 좌표를 검색합니다
	      geocoder.addr2coord(roomAddr, function(status, result) {

	          // 정상적으로 검색이 완료됐으면 
	           if (status === daum.maps.services.Status.OK) {
	             console.log(result.addr[0].lat);
	              var coords = new daum.maps.LatLng(result.addr[0].lat, result.addr[0].lng);

	              // 결과값으로 받은 위치를 마커로 표시합니다
	              var marker = new daum.maps.Marker({
	                  map: map,
	                  position: coords
	              });
	              // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
	              map.setCenter(coords);

			          roadviewClient.getNearestPanoId(coords, 50, function(panoId) {
			              roadview.setPanoId(panoId, coords);
			          });
	          } 
	      });    
	    
	  }
	// 지도와 로드뷰를 감싸고 있는 div의 class를 변경하여 지도를 숨기거나 보이게 하는 함수입니다 
	  function toggleMap(active) {
	      if (active) {
	    	  $("#roadview").css({"display":"none"});
	    	  $("#map").css({"display":"block"});
	      } else {
	    	  $("#roadview").css({"display":"block"});
	    	  $("#map").css({"display":"none"});
	      }
	  }
	  
	  
	  
	  
	  
	  
	  
	  
	
	
	$.ajax({
	  url:"items.json",
	  type:"GET",
	  dataType:"json",
	  success: function(data){
	  console.log(data);
	  var jsonArray = new Array();
	  var result = new Array();
	  for(var i = 0; i < data.datas.length;i++) {
	    jsonArray[i] = data.datas[i];
	  }
	  result[0] = jsonArray[0].building;
	  result[1] = jsonArray[0].agent_Info;
	  result[2] = jsonArray[0].inquiry;
	  result[3] = jsonArray[1].cost_Info;
	  result[4] = jsonArray[1].room_Info;
	  result[5] = jsonArray[1].others;
	  result[6] = jsonArray[1].detail_Desc;
	  console.log(result[4].room_img[1]);
	  console.log(result[4].room_img.length);
	  console.log("addr1:" +result[4].address1);
	  console.log("addr2:" +result[4].address2);
	  var images = "";
	  for(var i = 0; i< result[4].room_img.length;i++) {
	    images += "<li class='img_li' data-index='"+i+"'><img class='r_img' data-index='"+i+"' src='"+result[4].room_img[i].img+"'"+
	    "alt='roomInside"+i+"'/></li>"
	  }
	  $("#office_img").attr("src", result[0].img);
	  $("#office_name").text(result[0].name);
	  $("#office_addr").text(result[0].address1+" "+result[0].address2+" "+result[0].address3);
	  $("#office_floor").text(result[0].floor);
	  $("#office_rooms").text(result[0].rooms);
	  $("#office_est").text(result[0].established);
	  $(".agent_name").text(result[1].name);
	  $(".agent_img").attr("src",result[1].img);
	  $(".agent_email").text(result[1].email);
	  $(".agent_tel").text(result[1].tel);
	  $(".tel_Btn").attr("href","tel:"+result[1].tel);
	  $("#office_address").text(result[1].address+", "+result[1].office+" ("+result[1].owner+")");
	  $("#office_call>span").text(result[1].office_tel);
	  $(".agent_word").html(result[1].agent_word);
	  $(".inquiry_office").text(result[2].office +"("+result[2].owner+")");
	  $(".inquiry_agent").text(result[2].position+"("+result[2].agent+")");
	  $(".inquiry_tel").text(result[2].tel);
	  $(".r_deposit>strong").text(result[3].deposit);
	  $(".r_rentsCost>strong").text(result[3].rentsCost);
	  $(".r_id").text(result[3].id);
	  $(".r_address,.r_addr").text(result[4].address1+" "+result[4].address2);
	  roomAddr = result[4].address1+" "+result[4].address2;
	  $(".r_nearStation").text(result[4].nearStation1 + " " + result[4].nearStation2);
//    $(".r_img").attr("src",result[4].room_img1);
	  $("#imgSlider").html(images);
	  $(".r_floor").text(result[4].floor+"층/"+result[4].b_floor+"층");
	  $(".r_size").text(result[4].size1+" "+result[4].size2+" "+result[4].size3);
	  $(".r_structure").text(result[4].structure);
	  $(".r_form").text(result[4].form);
	  $(".r_intro").text(result[4].intro);
	  $(".r_option").text(result[5].options);
	  $(".r_maintenance").text(result[5].maintenance);
	  $(".r_maintenanceAdd").text(result[5].maintenanceAdd);
	  $(".r_parking").text(result[5].parking);
	  $(".r_elevator").text(result[5].elevator);
	  $(".r_date").text(result[5].date);
	  $(".r_desc").html(result[6].description);
//	  console.log("getJSON");
	  console.log("roomAddr.getJSON: "+roomAddr)
	  
	  $(".img_li").on("click",function(event){
	    console.log("clcicicicivcivcv");
	    $("#Modal-Wrap").css({"display":"block"});
	    $("#Modal-Wrap").css({"height":winH+"px"});
	    var imgH = $(".modal-img").height();
	    $(".modal-conts").css({"margin-top":((winH-imgH)/2-50)+"px"});
	  });
	  $("#Modal-Wrap").on("click",function(event) {
	    $("#Modal-Wrap").css({"display":"none"});
	  });
	  var imgWid = $(".img_li").width();
	  $("#back").on("click", function(event) {
	    var slider_index = parseInt($("#imgSlider").attr("data-index"));
	    console.log("back");
	    if(slider_index != 0) {
	      var slider_move = imgWid*(slider_index-1);
	      $("#imgSlider").css({"transform":"translate3d(-"+slider_move+"px,0px,0px)"});
	      $("#imgSlider").attr("data-index",slider_index-1);
	    }
	    console.log("BackBtn_data-index: "+ slider_index)
	  });
	  $("#next").on("click", function(event) {
	    var slider_index = parseInt($("#imgSlider").attr("data-index"));
	    console.log("next");
	    if(slider_index < result[4].room_img.length-1) {
	      var slider_move = imgWid*(slider_index+1);
	      $("#imgSlider").css({"transform":"translate3d(-"+slider_move+"px,0px,0px)"});
	      $("#imgSlider").attr("data-index",slider_index+1);
	    }
	    console.log("PrevBtn_data-index: "+ slider_index);
	    console.log(result[4].room_img.length);
	  });
	    map_addr(); //좌표로 변경 형 위치가 실행
	  }
	});
	</script>
</body>
</html>